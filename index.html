<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Treino</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0c0a09;
            color: #f5f5f5;
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #262626;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #4b5563;
            border-radius: 20px;
            border: 2px solid #262626;
        }
        .chart-container {
            display: flex;
            align-items: flex-end;
            gap: 0.5rem;
            height: 150px;
        }
        .bar {
            width: 1rem;
            background-color: #68d391;
            transition: height 0.3s ease-in-out;
            border-radius: 0.5rem 0.5rem 0 0;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-950 min-h-screen">

    <div id="app" class="p-4 md:p-10 flex flex-col min-h-screen">
        <div class="p-4 flex justify-end">
            <button id="toggle-role-btn" class="bg-purple-600 text-white p-2 rounded-xl hover:bg-purple-700 transition-colors duration-300">
                Alternar para Professor
            </button>
        </div>
        <div id="dashboard-content"></div>
    </div>

    <script>
        const app = document.getElementById('app');
        const content = document.getElementById('dashboard-content');
        const toggleRoleBtn = document.getElementById('toggle-role-btn');
        let isProfessor = false;

        // Ícones SVG para o visual do painel
        const icons = {
            Dumbbell: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2 text-teal-400"><path d="M14.4 14.4 9.6 9.6"/><path d="M18.8 9.2a3 3 0 1 1-4.2-4.2l-5.6 5.6a3 3 0 1 1 4.2 4.2l5.6-5.6z"/><path d="M21.2 2.8a3 3 0 1 1-4.2-4.2l-5.6 5.6a3 3 0 1 1 4.2 4.2l5.6-5.6z"/></svg>`,
            Clipboard: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></svg>`,
            ArrowLeft: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2"><path d="M19 12H5"/><polyline points="12 19 5 12 12 5"/></svg>`,
            Check: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-green-500"><polyline points="20 6 9 17 4 12"/></svg>`,
            Star: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-yellow-400"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`,
            Plus: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-green-400"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>`,
            Send: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-blue-400"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>`,
            Heart: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-red-400"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>`,
            ChartLine: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-teal-400"><path d="M3 3v18h18"/><path d="M18 10l-6 6-4-4-5 5"/></svg>`,
            Trophy: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-yellow-400"><path d="M12 12.8A6 6 0 1 0 5.2 2c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2a6 6 0 0 0-6.8 10.8z"/><path d="M12 12.8A6 6 0 1 0 18.8 2c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2a6 6 0 0 0 6.8 10.8z"/><path d="M22 17H2c0 2.2 1.8 4 4 4s4-1.8 4-4H12c0 2.2 1.8 4 4 4s4-1.8 4-4z"/></svg>`,
            Sparkles: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M22.844 10.02a.5.5 0 0 0-.447-.282L15.93 9.38l-2.028-6.17a.5.5 0 0 0-.946 0L10.07 9.38 3.153 9.738a.5.5 0 0 0-.447.282l2.67 6.45-3.045 4.965a.5.5 0 0 0 .848.517l6.55-2.01 6.55 2.01a.5.5 0 0 0 .848-.517l-3.045-4.965 2.67-6.45z"/></svg>`,
            Sun: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>`,
            Medal: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-amber-400"><path d="M12 18V6"/><path d="M14 12V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8l3 3z"/><path d="M10 18v6"/><path d="M14 18v6"/></svg>`,
            Bolt: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2 text-yellow-400"><path d="M13 14h-4l-3 6h7l-3-6z"/><path d="M15 10l-3-6h7l-3 6z"/></svg>`,
        };

        let userData = {
            points: 0,
            personalRecords: {
                mostPointsDay: 0,
            },
            pointHistory: [],
            dailyCardioMinutes: {},
            unlockedAchievements: [],
        };
        let treinoData = [];
        let profTreinoData = [];
        let currentPage = 'dashboard';
        let selectedTreino = null;

        // Dados das conquistas
        const allAchievements = [
            { id: 'primeiros-passos', name: 'Primeiros Passos', description: 'Acumule 100 pontos.', pointsRequired: 100, icon: 'Sparkles', color: 'text-purple-400' },
            { id: 'meio-caminho', name: 'Meio Caminho', description: 'Acumule 500 pontos.', pointsRequired: 500, icon: 'Dumbbell', color: 'text-teal-400' },
            { id: 'estrela-do-treino', name: 'Estrela do Treino', description: 'Acumule 1000 pontos.', pointsRequired: 1000, icon: 'Trophy', color: 'text-yellow-400' },
        ];

        // -----------------------------------------------------------
        // Funções para gerenciar dados no localStorage
        // -----------------------------------------------------------
        const loadUserData = () => {
            const storedData = localStorage.getItem('treino-app-data');
            if (storedData) {
                const parsedData = JSON.parse(storedData);
                userData = { ...userData, ...parsedData };
            }
        };

        const saveUserData = () => {
            localStorage.setItem('treino-app-data', JSON.stringify(userData));
        };

       const loadTreinoData = () => {
    const storedTreino = localStorage.getItem('treino-aluno');
    if (storedTreino) {
        treinoData = JSON.parse(storedTreino);
    } else {
        treinoData = [
            {
                id: 'treino-1',
                titulo: 'Treino de Costas e Bíceps',
                descricao: 'Foco no desenvolvimento de costas e bíceps.',
                exercicios: [
                    { nome: 'Remada Baixa Unilateral', series: '4', repeticoes: '8-10', carga: 'Carga Desafiadora', mediaUrl: 'https://www.youtube.com/embed/gT2895S1aI4', mediaType: 'video' },
                    { nome: 'Remada Curvada Pegada Pronada', series: '4', repeticoes: '10-12', carga: '40kg', mediaUrl: 'https://placehold.co/600x400/90EE90/000?text=Remada+Curvada', mediaType: 'image' },
                    { nome: 'Puxada Alta na Frente', series: '4', repeticoes: '10-12', carga: '40kg', mediaUrl: 'https://www.youtube.com/embed/ultjWp9fR6Q', mediaType: 'video' },
                    { nome: 'Pulldown', series: '3', repeticoes: '10-12', carga: '20kg', mediaUrl: 'https://placehold.co/600x400/ADD8E6/000?text=Pulldown', mediaType: 'image' },
                    { nome: 'Rosca Direta com Barra', series: '4', repeticoes: '10-12', carga: '20kg', mediaUrl: 'https://www.youtube.com/embed/eTz5J-2Bf7w', mediaType: 'video' },
                ]
            },
            {
                id: 'treino-2',
                titulo: 'Treino de Pernas e Glúteos',
                descricao: 'Foco em pernas (quadríceps e posteriores) e glúteos.',
                exercicios: [
                    { nome: 'Agachamento Búlgaro', series: '5', repeticoes: '10-12', carga: 'Carga Desafiadora', mediaUrl: 'https://placehold.co/600x400/FFB6C1/000?text=Agachamento+Bulgaro', mediaType: 'image' },
                    { nome: 'Elevação de Quadril', series: '5', repeticoes: '8-10', carga: 'Carga Desafiadora', mediaUrl: 'https://www.youtube.com/embed/yQ0a400f6jU', mediaType: 'video' },
                    { nome: 'Stiff', series: '4', repeticoes: '12-15', carga: '30kg', mediaUrl: 'https://placehold.co/600x400/98FB98/000?text=Stiff', mediaType: 'image' },
                    { nome: 'Passada com Halteres', series: '4', repeticoes: '10', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/bNnFwTj000I', mediaType: 'video' },
                    { nome: 'Glúteo Coice na Polia', series: '3', repeticoes: '15-20', carga: '30kg', mediaUrl: 'https://placehold.co/600x400/FFD700/000?text=Gluteo+Coice', mediaType: 'image' },
                ]
            },
            {
                id: 'treino-3',
                titulo: 'Treino de Peito, Ombros e Tríceps',
                descricao: 'Foco no desenvolvimento de peito, ombros e tríceps.',
                exercicios: [
                    { nome: 'Supino Inclinado com Halteres', series: '4', repeticoes: '8-10', carga: '60kg', mediaUrl: 'https://www.youtube.com/embed/rV16Q85s9gM', mediaType: 'video' },
                    { nome: 'Desenvolvimento de Ombros com Barra', series: '4', repeticoes: '8-10', carga: 'Carga Desafiadora', mediaUrl: 'https://placehold.co/600x400/B0E0E6/000?text=Desenvolvimento', mediaType: 'image' },
                    { nome: 'Crucifixo Inclinado com Halteres', series: '4', repeticoes: '12-15', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/j_hXq38rD8o', mediaType: 'video' },
                    { nome: 'Elevação Lateral com Halteres', series: '4', repeticoes: '10', carga: '30kg', mediaUrl: 'https://placehold.co/600x400/F08080/000?text=Elevacao+Lateral', mediaType: 'image' },
                    { nome: 'Tríceps Testa com Barra W', series: '3', repeticoes: '15-20', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/c29vI-B1V8Y', mediaType: 'video' },
                    { nome: 'Paralela', series: '3', repeticoes: '15-20', carga: 'Carga Desafiadora', mediaUrl: 'https://placehold.co/600x400/DDA0DD/000?text=Paralela', mediaType: 'image' },
                ]
            },
            {
                id: 'treino-4',
                titulo: 'Treino de Quadríceps e Panturrilhas',
                descricao: 'Foco na força e volume dos quadríceps e panturrilhas.',
                exercicios: [
                    { nome: 'Agachamento Livre', series: '4', repeticoes: '8-10', carga: '60kg', mediaUrl: 'https://www.youtube.com/embed/ultjWp9fR6Q', mediaType: 'video' },
                    { nome: 'Leg Press 45', series: '5', repeticoes: '8-10', carga: '100kg', mediaUrl: 'https://placehold.co/600x400/FFB6C1/000?text=Leg+Press', mediaType: 'image' },
                    { nome: 'Cadeira Extensora', series: '4', repeticoes: '12-15', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/u1QeJk8Fq6A', mediaType: 'video' },
                    { nome: 'Hack Squat', series: '4', repeticoes: '10', carga: '30kg', mediaUrl: 'https://placehold.co/600x400/98FB98/000?text=Hack+Squat', mediaType: 'image' },
                    { nome: 'Panturrilhas', series: '3', repeticoes: '15-20', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/u1QeJk8Fq6A', mediaType: 'video' },
                ]
            },
            {
                id: 'treino-5',
                titulo: 'Treino de Peito e Costas',
                descricao: 'Treino de volume para peito e costas.',
                exercicios: [
                    { nome: 'Supino Reto com Barra', series: '4', repeticoes: '8-10', carga: '60kg', mediaUrl: 'https://www.youtube.com/embed/R2IqO4J77dY', mediaType: 'video' },
                    { nome: 'Remada Cavalinho', series: '5', repeticoes: '8-10', carga: '100kg', mediaUrl: 'https://placehold.co/600x400/E6E6FA/000?text=Remada+Cavalinho', mediaType: 'image' },
                    { nome: 'Crossover', series: '4', repeticoes: '12-15', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/rV16Q85s9gM', mediaType: 'video' },
                    { nome: 'Puxada com Pegada Fechada (Triângulo)', series: '4', repeticoes: '10', carga: '30kg', mediaUrl: 'https://placehold.co/600x400/FFDEAD/000?text=Puxada+Fechada', mediaType: 'image' },
                    { nome: 'Desenvolvimento de Ombros com Halteres', series: '3', repeticoes: '15-20', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/j_hXq38rD8o', mediaType: 'video' },
                    { nome: 'Remada Alta', series: '3', repeticoes: '15-20', carga: '30kg', mediaUrl: 'https://placehold.co/600x400/B0C4DE/000?text=Remada+Alta', mediaType: 'image' },
                ]
            },
            {
                id: 'treino-6',
                titulo: 'Treino de Posterior de Coxa e Panturrilhas',
                descricao: 'Treino focado em posteriores e panturrilhas.',
                exercicios: [
                    { nome: 'Stiff com Barra', series: '4', repeticoes: '8-10', carga: '60kg', mediaUrl: 'https://www.youtube.com/embed/R2IqO4J77dY', mediaType: 'video' },
                    { nome: 'Mesa Flexora', series: '5', repeticoes: '8-10', carga: '100kg', mediaUrl: 'https://placehold.co/600x400/E6E6FA/000?text=Mesa+Flexora', mediaType: 'image' },
                    { nome: 'Leg Press Unilateral', series: '4', repeticoes: '12-15', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/j_hXq38rD8o', mediaType: 'video' },
                    { nome: 'Cadeira Flexora', series: '4', repeticoes: '10', carga: '30kg', mediaUrl: 'https://placehold.co/600x400/B0C4DE/000?text=Cadeira+Flexora', mediaType: 'image' },
                    { nome: 'Panturrilhas', series: '3', repeticoes: '15-20', carga: '30kg', mediaUrl: 'https://www.youtube.com/embed/c29vI-B1V8Y', mediaType: 'video' },
                ]
            }
        ];
        localStorage.setItem('treino-aluno', JSON.stringify(treinoData));
    }
};

        const loadProfTreinoData = () => {
            const storedProfTreino = localStorage.getItem('treino-prof');
            if (storedProfTreino) {
                profTreinoData = JSON.parse(storedProfTreino);
            } else {
                profTreinoData = [...treinoData];
                localStorage.setItem('treino-prof', JSON.stringify(profTreinoData));
            }
        };

        // -----------------------------------------------------------
        // Funções de Renderização
        // -----------------------------------------------------------
        const render = () => {
            loadUserData();
            if (isProfessor) {
                loadProfTreinoData();
                renderProfessorDashboard();
                toggleRoleBtn.innerText = 'Alternar para Aluno';
            } else {
                loadTreinoData();
                if (currentPage === 'dashboard') {
                    renderAlunoDashboard();
                } else if (currentPage === 'workoutDetails') {
                    renderWorkoutDetails();
                }
                toggleRoleBtn.innerText = 'Alternar para Professor';
            }
        };

        const renderAlunoDashboard = () => {
            content.innerHTML = `
                <div class="min-h-screen bg-gray-950 text-white p-6 md:p-10">
                    <header class="flex flex-col md:flex-row justify-between items-center mb-10">
                        <h1 class="text-4xl md:text-5xl font-extrabold text-white">
                            Olá, <span class="text-teal-400">Ananda</span>!
                        </h1>
                        <div class="flex items-center space-x-4 mt-4 md:mt-0">
                            <span class="text-white text-xl font-bold flex items-center">
                                ${icons.Star}
                                <span id="points-display">${userData.points} pontos</span>
                            </span>
                        </div>
                    </header>

                    <div id="status-message" class="hidden bg-teal-500 text-white p-3 rounded-xl mb-4 text-center"></div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 space-y-6">
                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                                <h2 class="text-2xl font-bold text-white mb-4">Seus Treinos</h2>
                                <div id="treino-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                            </div>

                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                                <h2 class="text-2xl font-bold text-white mb-4 flex items-center">
                                    ${icons.Heart}
                                    Meta de Cardio
                                </h2>
                                <div class="flex flex-col items-center text-center space-y-2 mb-4">
                                    <p class="text-white text-4xl font-extrabold" id="cardio-total">0 / 210 min</p>
                                    <p class="text-gray-400">Restam <span class="text-white font-bold" id="cardio-remaining">0</span> minutos esta semana.</p>
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-3 mb-4">
                                    <div id="cardio-progress-bar" class="bg-red-500 h-3 rounded-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                                <form id="cardio-form" class="space-y-2">
                                    <label class="block text-gray-400 text-sm">Adicionar minutos de cardio hoje:</label>
                                    <input type="number" id="cardio-input" class="w-full p-2 rounded-xl bg-gray-800 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-white text-center" placeholder="Ex: 30" required />
                                    <button type="submit" class="w-full bg-red-600 text-white font-bold py-2 rounded-xl hover:bg-red-700 transition-all duration-300">
                                        Adicionar
                                    </button>
                                </form>
                            </div>

                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                                <h2 class="text-2xl font-bold text-white mb-4">Seu Progresso Semanal</h2>
                                <div id="cardio-chart" class="chart-container"></div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700 flex flex-col justify-between">
                                <h2 class="text-xl font-semibold text-white flex items-center mb-4">
                                    ${icons.Bolt}
                                    Desafio do Dia
                                </h2>
                                <div class="text-center flex-grow flex flex-col justify-center items-center">
                                    <p class="text-white text-lg font-medium" id="daily-challenge-text"></p>
                                </div>
                                <button id="complete-challenge-btn" class="w-full font-bold py-3 mt-4 rounded-xl transition-all duration-300 bg-yellow-600 hover:bg-yellow-700">
                                    Marcar como Concluído
                                </button>
                            </div>
                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                                <h2 class="text-xl font-semibold text-white mb-4 flex items-center">
                                    ${icons.Medal}
                                    Meus Recordes Pessoais
                                </h2>
                                <ul class="space-y-3">
                                    <li class="flex items-center justify-between p-3 rounded-xl bg-gray-800">
                                        <div class="flex items-center space-x-3">
                                            <span class="text-white font-medium">Maior Pontuação:</span>
                                        </div>
                                        <span id="most-points" class="text-yellow-400 font-bold">0 pts</span>
                                    </li>
                                </ul>
                            </div>
                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                                <h2 class="text-xl font-semibold text-white mb-4 flex items-center">
                                    ${icons.Trophy}
                                    Minhas Conquistas
                                </h2>
                                <div id="achievements-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                            </div>
                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                                <h2 class="text-xl font-semibold text-white mb-4 flex items-center">
                                    ${icons.ChartLine}
                                    Histórico de Pontos
                                </h2>
                                <div id="points-chart" class="chart-container"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
           
            setupAlunoDashboard();
        };

        const setupAlunoDashboard = () => {
            const getDayName = (dayIndex) => ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'][dayIndex];
            const getDailyCardioData = () => {
                const data = [];
                const today = new Date();
                const firstDayOfWeek = new Date(today);
                firstDayOfWeek.setDate(today.getDate() - today.getDay() + (today.getDay() === 0 ? -6 : 1));
                for(let i = 0; i < 7; i++) {
                    const day = new Date(firstDayOfWeek);
                    day.setDate(firstDayOfWeek.getDate() + i);
                    const dayKey = day.toLocaleDateString();
                    data.push({
                        name: getDayName(day.getDay()),
                        minutos: userData.dailyCardioMinutes[dayKey] || 0
                    });
                }
                return data;
            };

            const cardioChartData = getDailyCardioData();
            const cardioChartContainer = document.getElementById('cardio-chart');
            cardioChartContainer.innerHTML = ''; // Limpar o gráfico
            cardioChartData.forEach(day => {
                const bar = document.createElement('div');
                bar.classList.add('bar', 'bg-red-500');
                bar.style.height = `${Math.min(100, (day.minutos / 60) * 100)}%`;
                bar.setAttribute('title', `${day.name}: ${day.minutos} min`);
                cardioChartContainer.appendChild(bar);
            });

            const pointsChartContainer = document.getElementById('points-chart');
            pointsChartContainer.innerHTML = '';
            userData.pointHistory.forEach(data => {
                const bar = document.createElement('div');
                bar.classList.add('bar', 'bg-green-500');
                bar.style.height = `${Math.min(100, (data.points / 1000) * 100)}%`;
                bar.setAttribute('title', `${data.date}: ${data.points} pts`);
                pointsChartContainer.appendChild(bar);
            });

            const renderTreinoList = () => {
                const treinoListDiv = document.getElementById('treino-list');
                treinoListDiv.innerHTML = '';
                if (treinoData.length === 0) {
                    treinoListDiv.innerHTML = `<div class="text-center text-gray-500 p-8 col-span-2"><p>Nenhum treino atribuído ainda. Peça para o professor atribuir um!</p></div>`;
                } else {
                    treinoData.forEach(treino => {
                        const treinoCard = document.createElement('div');
                        treinoCard.classList.add('bg-gray-800', 'p-6', 'rounded-2xl', 'shadow-lg', 'border', 'border-gray-700', 'cursor-pointer', 'hover:bg-gray-700', 'transition-colors', 'duration-200');
                        treinoCard.innerHTML = `
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-xl font-semibold text-white flex items-center">
                                    ${icons.Dumbbell}
                                    ${treino.titulo}
                                </h3>
                                <span class="bg-teal-600 text-white text-xs font-bold px-3 py-1 rounded-full">Ver Treino</span>
                            </div>
                            <p class="text-gray-400 text-sm">${treino.descricao}</p>
                        `;
                        treinoCard.addEventListener('click', () => {
                            selectedTreino = treino;
                            currentPage = 'workoutDetails';
                            render();
                        });
                        treinoListDiv.appendChild(treinoCard);
                    });
                }
            };

            const renderCardioProgress = () => {
                const weeklyTotal = Object.values(userData.dailyCardioMinutes).reduce((sum, val) => sum + val, 0);
                const remaining = Math.max(0, 210 - weeklyTotal);
                const progress = Math.min(100, (weeklyTotal / 210) * 100);
                document.getElementById('cardio-total').innerText = `${weeklyTotal} / 210 min`;
                document.getElementById('cardio-remaining').innerText = remaining;
                document.getElementById('cardio-progress-bar').style.width = `${progress}%`;
            };

            const renderAchievements = () => {
                const achievementsList = document.getElementById('achievements-list');
                achievementsList.innerHTML = '';
                allAchievements.forEach(ach => {
                    const isUnlocked = userData.unlockedAchievements.some(unlockedAch => unlockedAch.id === ach.id);
                    const achievementCard = document.createElement('div');
                    const iconSvg = icons[ach.icon];
                    achievementCard.classList.add('p-4', 'rounded-2xl', 'flex', 'flex-col', 'items-center', 'text-center', 'transition-all', 'duration-300', isUnlocked ? 'bg-teal-700' : 'bg-gray-800', isUnlocked ? 'opacity-100' : 'opacity-50');
                    achievementCard.innerHTML = `
                        <span class="w-12 h-12 flex items-center justify-center rounded-full mb-2 ${isUnlocked ? 'bg-yellow-400 text-gray-900' : 'bg-gray-500 text-gray-400'}">
                            ${iconSvg}
                        </span>
                        <h3 class="text-lg font-bold text-white mb-1">${ach.name}</h3>
                        <p class="text-xs text-gray-400">${ach.description}</p>
                    `;
                    achievementsList.appendChild(achievementCard);
                });
            };

            const updatePointsDisplay = () => {
                document.getElementById('points-display').innerText = `${userData.points} pontos`;
                document.getElementById('most-points').innerText = `${userData.personalRecords.mostPointsDay} pts`;
            };

            const showStatusMessage = (message, isError = false) => {
                const statusDiv = document.getElementById('status-message');
                statusDiv.innerText = message;
                statusDiv.classList.remove('hidden', 'bg-red-500', 'bg-teal-500');
                statusDiv.classList.add(isError ? 'bg-red-500' : 'bg-teal-500');
                setTimeout(() => statusDiv.classList.add('hidden'), 3000);
            };

            const challenges = [
                { id: 1, description: 'Faça 100 abdominais para aquecer.' },
                { id: 2, description: 'Complete 30 minutos de cardio.' },
                { id: 3, description: 'Caminhe 10.000 passos hoje.' },
                { id: 4, description: 'Faça 50 flexões.' },
                { id: 5, description: 'Faça alongamento por 15 minutos.' },
            ];

            const getDailyChallenge = () => {
                const today = new Date();
                const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
                return challenges[dayOfYear % challenges.length];
            };
           
            const dailyChallenge = getDailyChallenge();
            const dailyChallengeText = document.getElementById('daily-challenge-text');
            dailyChallengeText.innerText = dailyChallenge.description;
           
            const completeChallengeBtn = document.getElementById('complete-challenge-btn');
            const isChallengeCompleted = localStorage.getItem('challenge-completed-date') === new Date().toLocaleDateString();
            if (isChallengeCompleted) {
                completeChallengeBtn.disabled = true;
                completeChallengeBtn.innerText = 'Concluído!';
                completeChallengeBtn.classList.remove('bg-yellow-600', 'hover:bg-yellow-700');
                completeChallengeBtn.classList.add('bg-green-600', 'cursor-not-allowed');
            } else {
                completeChallengeBtn.disabled = false;
                completeChallengeBtn.innerText = 'Marcar como Concluído';
                completeChallengeBtn.classList.remove('bg-green-600', 'cursor-not-allowed');
                completeChallengeBtn.classList.add('bg-yellow-600', 'hover:bg-yellow-700');
            }

            completeChallengeBtn.addEventListener('click', () => {
                if (!isChallengeCompleted) {
                    userData.points += 50;
                    saveUserData();
                    localStorage.setItem('challenge-completed-date', new Date().toLocaleDateString());
                    updatePointsDisplay();
                    renderAchievements();
                    showStatusMessage('Desafio do dia concluído! Ótimo trabalho.');
                    render();
                }
            });

            const cardioForm = document.getElementById('cardio-form');
            cardioForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const minutes = parseInt(document.getElementById('cardio-input').value, 10);
                if (minutes > 0) {
                    userData.points += minutes * 2;
                    const todayKey = new Date().toLocaleDateString();
                    userData.dailyCardioMinutes[todayKey] = (userData.dailyCardioMinutes[todayKey] || 0) + minutes;
                    saveUserData();
                    document.getElementById('cardio-input').value = '';
                    updatePointsDisplay();
                    renderCardioProgress();
                    renderAchievements();
                    showStatusMessage(`+${minutes} minutos de cardio adicionados!`);
                } else {
                    showStatusMessage('Por favor, insira um valor válido.', true);
                }
            });

            const checkForNewAchievements = () => {
                const unlockedIds = new Set(userData.unlockedAchievements.map(a => a.id));
                const newUnlocked = allAchievements.filter(ach =>
                    !unlockedIds.has(ach.id) && ach.pointsRequired && userData.points >= ach.pointsRequired
                );
                if (newUnlocked.length > 0) {
                    userData.unlockedAchievements.push(...newUnlocked);
                    saveUserData();
                    newUnlocked.forEach(ach => showStatusMessage(`Parabéns! Você desbloqueou a conquista: "${ach.name}"!`));
                    renderAchievements();
                }
            };
           
            renderTreinoList();
            updatePointsDisplay();
            renderCardioProgress();
            renderAchievements();
            checkForNewAchievements();
        };

        const renderWorkoutDetails = () => {
            if (!selectedTreino) {
                currentPage = 'dashboard';
                render();
                return;
            }

            content.innerHTML = `
                <div class="min-h-screen bg-gray-950 text-white p-6 md:p-10">
                    <button id="back-to-dashboard" class="flex items-center text-gray-400 hover:text-white transition-colors duration-200 mb-8">
                        ${icons.ArrowLeft}
                        Voltar para o Dashboard
                    </button>
                   
                    <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-2">${selectedTreino.titulo}</h1>
                    <p class="text-gray-400 mb-6">${selectedTreino.descricao}</p>

                    <div id="exercises-container" class="space-y-6"></div>
                   
                    <button id="finalize-workout-btn" class="w-full font-bold py-4 mt-6 rounded-xl transition-all duration-300 bg-gray-800 text-gray-500 cursor-not-allowed" disabled>
                        Complete todos os exercícios para finalizar
                    </button>
                </div>
            `;
           
            const exercisesContainer = document.getElementById('exercises-container');
            let completedExercises = new Set();
           
            const updateFinalizeButton = () => {
                const finalizeBtn = document.getElementById('finalize-workout-btn');
                if (completedExercises.size === selectedTreino.exercicios.length) {
                    finalizeBtn.disabled = false;
                    finalizeBtn.innerText = 'Finalizar Treino';
                    finalizeBtn.classList.remove('bg-gray-800', 'text-gray-500', 'cursor-not-allowed');
                    finalizeBtn.classList.add('bg-purple-600', 'hover:bg-purple-700');
                } else {
                    finalizeBtn.disabled = true;
                    finalizeBtn.innerText = 'Complete todos os exercícios para finalizar';
                    finalizeBtn.classList.remove('bg-purple-600', 'hover:bg-purple-700');
                    finalizeBtn.classList.add('bg-gray-800', 'text-gray-500', 'cursor-not-allowed');
                }
            };
           
            selectedTreino.exercicios.forEach((exercicio, index) => {
                const isVideo = exercicio.mediaType === 'video';
                const exerciseDiv = document.createElement('div');
                exerciseDiv.classList.add('bg-gray-900', 'p-6', 'rounded-2xl', 'shadow-lg', 'border', 'border-gray-700');
                exerciseDiv.innerHTML = `
                    <h2 class="text-2xl font-bold text-white mb-2 flex justify-between items-center">
                        ${exercicio.nome}
                        <span id="check-${index}" class="hidden">${icons.Check}</span>
                    </h2>
                    <div class="flex items-center space-x-4 text-gray-400 mb-4">
                        <span class="font-semibold">${exercicio.series} Séries</span>
                        <span>•</span>
                        <span class="font-semibold">${exercicio.repeticoes} Repetições</span>
                        <span>•</span>
                        <span class="font-semibold">${exercicio.carga} Carga</span>
                    </div>
                    ${exercicio.mediaUrl ? `
                    <div class="aspect-video bg-gray-800 rounded-xl overflow-hidden mb-4">
                        ${isVideo ?
                            `<iframe class="w-full h-full" src="${exercicio.mediaUrl}" title="Video de Exemplo do Exercício" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`
                            :
                            `<img src="${exercicio.mediaUrl}" alt="${exercicio.nome}" class="w-full h-full object-cover"/>`
                        }
                    </div>` : ''}
                    <button id="complete-ex-${index}" class="w-full font-bold py-3 rounded-xl transition-all duration-300 bg-teal-600 hover:bg-teal-700 text-white">
                        Marcar como Concluído
                    </button>
                `;
                exercisesContainer.appendChild(exerciseDiv);

                document.getElementById(`complete-ex-${index}`).addEventListener('click', () => {
                    if (completedExercises.has(index)) {
                        completedExercises.delete(index);
                        document.getElementById(`check-${index}`).classList.add('hidden');
                        document.getElementById(`complete-ex-${index}`).innerText = 'Marcar como Concluído';
                        document.getElementById(`complete-ex-${index}`).classList.remove('bg-green-600', 'hover:bg-green-700');
                        document.getElementById(`complete-ex-${index}`).classList.add('bg-teal-600', 'hover:bg-teal-700');
                    } else {
                        completedExercises.add(index);
                        document.getElementById(`check-${index}`).classList.remove('hidden');
                        document.getElementById(`complete-ex-${index}`).innerText = 'Concluído!';
                        document.getElementById(`complete-ex-${index}`).classList.remove('bg-teal-600', 'hover:bg-teal-700');
                        document.getElementById(`complete-ex-${index}`).classList.add('bg-green-600', 'hover:bg-green-700');
                    }
                    updateFinalizeButton();
                });
            });

            document.getElementById('back-to-dashboard').addEventListener('click', () => {
                currentPage = 'dashboard';
                render();
            });

            document.getElementById('finalize-workout-btn').addEventListener('click', () => {
                userData.points += 100;
                const today = new Date().toLocaleDateString();
                const todayIndex = userData.pointHistory.findIndex(d => d.date === today);
                if (todayIndex > -1) {
                    userData.pointHistory[todayIndex].points = userData.points;
                } else {
                    userData.pointHistory.push({ date: today, points: userData.points });
                }
                if (userData.points > userData.personalRecords.mostPointsDay) {
                    userData.personalRecords.mostPointsDay = userData.points;
                }
                saveUserData();
                currentPage = 'dashboard';
                render();
            });
        };

        const renderProfessorDashboard = () => {
            content.innerHTML = `
                <div class="min-h-screen bg-gray-950 text-white p-6 md:p-10">
                    <header class="flex flex-col md:flex-row justify-between items-center mb-10">
                        <h1 class="text-4xl md:text-5xl font-extrabold text-white">
                            Painel do <span class="text-teal-400">Professor</span>
                        </h1>
                    </header>

                    <div id="status-message" class="hidden bg-teal-500 text-white p-3 rounded-xl mb-4 text-center"></div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                            <h2 class="text-2xl font-bold text-white mb-4 flex items-center">
                                ${icons.Plus}
                                Criar Novo Treino
                            </h2>
                            <form id="create-treino-form" class="space-y-4">
                                <div>
                                    <label class="block text-gray-400">Título do Treino</label>
                                    <input type="text" id="new-treino-titulo" class="w-full p-2 rounded-xl bg-gray-800 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-teal-500" required />
                                </div>
                                <div>
                                    <label class="block text-gray-400">Descrição</label>
                                    <textarea id="new-treino-descricao" rows="3" class="w-full p-2 rounded-xl bg-gray-800 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-teal-500" required></textarea>
                                </div>
                                <div id="exercicios-container">
                                    <h3 class="text-lg font-semibold text-white mb-2">Exercícios</h3>
                                </div>
                                <button type="button" id="add-exercise-btn" class="w-full bg-gray-700 text-white p-2 rounded-xl hover:bg-gray-600 transition-colors duration-200">
                                    Adicionar Exercício
                                </button>
                                <button type="submit" class="w-full bg-teal-600 text-white font-bold p-3 rounded-xl hover:bg-teal-700 transition-all duration-300">
                                    Salvar Treino
                                </button>
                            </form>
                        </div>

                        <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                            <h2 class="text-2xl font-bold text-white mb-4 flex items-center">
                                ${icons.Send}
                                Atribuir Treino
                            </h2>
                            <form id="assign-treino-form" class="space-y-4">
                                <div>
                                    <label class="block text-gray-400">Treino a Atribuir</label>
                                    <select id="assign-treino-id" class="w-full p-2 rounded-xl bg-gray-800 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                        <option value="">-- Selecione um Treino --</option>
                                    </select>
                                </div>
                                <button type="submit" class="w-full bg-blue-600 text-white font-bold p-3 rounded-xl hover:bg-blue-700 transition-all duration-300">
                                    Atribuir Treino
                                </button>
                            </form>
                        </div>

                        <div class="lg:col-span-2 space-y-6">
                            <div class="bg-gray-900 p-6 rounded-2xl shadow-lg border border-gray-700">
                                <h2 class="text-2xl font-bold text-white mb-4">Treinos Criados</h2>
                                <ul id="prof-treino-list" class="space-y-2"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
           
            setupProfessorDashboard();
        };

        const setupProfessorDashboard = () => {
            const exerciciosContainer = document.getElementById('exercicios-container');
            const addExerciseBtn = document.getElementById('add-exercise-btn');
            const createTreinoForm = document.getElementById('create-treino-form');
            const assignTreinoForm = document.getElementById('assign-treino-form');
            const assignTreinoSelect = document.getElementById('assign-treino-id');
            const profTreinoList = document.getElementById('prof-treino-list');

            let newTreinoExercicios = [{ nome: '', series: '', repeticoes: '', carga: '', mediaUrl: '', mediaType: 'image' }];

            const showStatusMessage = (message, isError = false) => {
                const statusDiv = document.getElementById('status-message');
                statusDiv.innerText = message;
                statusDiv.classList.remove('hidden', 'bg-red-500', 'bg-teal-500');
                statusDiv.classList.add(isError ? 'bg-red-500' : 'bg-teal-500');
                setTimeout(() => statusDiv.classList.add('hidden'), 3000);
            };

            const renderExercicios = () => {
                exerciciosContainer.innerHTML = '<h3 class="text-lg font-semibold text-white mb-2">Exercícios</h3>';
                newTreinoExercicios.forEach((ex, index) => {
                    const exDiv = document.createElement('div');
                    exDiv.classList.add('bg-gray-800', 'p-4', 'rounded-xl', 'mb-4', 'space-y-2');
                    exDiv.innerHTML = `
                        <div class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2">
                            <input type="text" placeholder="Nome do Exercício" value="${ex.nome}" data-field="nome" data-index="${index}" class="w-full p-2 rounded-xl bg-gray-700 border border-gray-600" required />
                            <input type="text" placeholder="Séries" value="${ex.series}" data-field="series" data-index="${index}" class="w-full p-2 rounded-xl bg-gray-700 border border-gray-600" required />
                            <input type="text" placeholder="Repetições" value="${ex.repeticoes}" data-field="repeticoes" data-index="${index}" class="w-full p-2 rounded-xl bg-gray-700 border border-gray-600" required />
                        </div>
                        <input type="text" placeholder="Carga (ex: 15kg)" value="${ex.carga}" data-field="carga" data-index="${index}" class="w-full p-2 rounded-xl bg-gray-700 border border-gray-600" required />
                        <div class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2">
                            <input type="text" placeholder="URL de Vídeo ou Imagem" value="${ex.mediaUrl}" data-field="mediaUrl" data-index="${index}" class="w-full p-2 rounded-xl bg-gray-700 border border-gray-600" />
                            <select data-field="mediaType" data-index="${index}" class="w-full p-2 rounded-xl bg-gray-700 border border-gray-600">
                                <option value="image" ${ex.mediaType === 'image' ? 'selected' : ''}>Imagem</option>
                                <option value="video" ${ex.mediaType === 'video' ? 'selected' : ''}>Vídeo</option>
                            </select>
                        </div>
                    `;
                    exerciciosContainer.appendChild(exDiv);
                });
            };

            addExerciseBtn.addEventListener('click', () => {
                newTreinoExercicios.push({ nome: '', series: '', repeticoes: '', carga: '', mediaUrl: '', mediaType: 'image' });
                renderExercicios();
            });

            exerciciosContainer.addEventListener('input', (e) => {
                const { field, index } = e.target.dataset;
                if (field && index) {
                    newTreinoExercicios[index][field] = e.target.value;
                }
            });

            createTreinoForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const titulo = document.getElementById('new-treino-titulo').value;
                const descricao = document.getElementById('new-treino-descricao').value;
                const newId = `treino-prof-${profTreinoData.length + 1}`;
                profTreinoData.push({ id: newId, titulo, descricao, exercicios: newTreinoExercicios });
                localStorage.setItem('treino-prof', JSON.stringify(profTreinoData));
               
                document.getElementById('new-treino-titulo').value = '';
                document.getElementById('new-treino-descricao').value = '';
                newTreinoExercicios = [{ nome: '', series: '', repeticoes: '', carga: '', mediaUrl: '', mediaType: 'image' }];
                renderExercicios();
                renderProfessorLists();
                showStatusMessage('Treino criado com sucesso!');
            });
           
            const renderProfessorLists = () => {
                profTreinoList.innerHTML = '';
                assignTreinoSelect.innerHTML = '<option value="">-- Selecione um Treino --</option>';
                profTreinoData.forEach(treino => {
                    const li = document.createElement('li');
                    li.classList.add('bg-gray-800', 'p-3', 'rounded-xl', 'flex', 'justify-between', 'items-center');
                    li.innerHTML = `<span>${treino.titulo}</span><span class="text-xs text-gray-500">ID: ${treino.id}</span>`;
                    profTreinoList.appendChild(li);

                    const option = document.createElement('option');
                    option.value = treino.id;
                    option.innerText = treino.titulo;
                    assignTreinoSelect.appendChild(option);
                });
            };

            assignTreinoForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const treinoId = document.getElementById('assign-treino-id').value;
                const treinoToAssign = profTreinoData.find(t => t.id === treinoId);
                if (treinoToAssign) {
                    treinoData.push(treinoToAssign);
                    localStorage.setItem('treino-aluno', JSON.stringify(treinoData));
                    showStatusMessage('Treino atribuído com sucesso!');
                } else {
                    showStatusMessage('Erro ao atribuir treino. ID não encontrado.', true);
                }
            });

            renderExercicios();
            renderProfessorLists();
        };

        // -----------------------------------------------------------
        // Eventos Globais e Início da Aplicação
        // -----------------------------------------------------------
        toggleRoleBtn.addEventListener('click', () => {
            isProfessor = !isProfessor;
            currentPage = 'dashboard';
            render();
        });

        // Inicia a aplicação na primeira carga da página
        render();

    </script>
</body>
</html>